<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.suph.security.core.resourcedetails.jdbc.dao.SecuredObjectDAO">

	<resultMap type="com.suph.security.core.resourcedetails.jdbc.vo.RoleVO" id="RoleVO">
		<result column="RESOURCE_PATTERN" property="pattern" />
		<result column="AUTH_NM" property="authority" />
	</resultMap>

	<!-- url/method/pointcut 형식인 리소스 패턴 - 권한 매핑 정보를 조회합니다 -->
	<select id="getRolesAndResources" parameterType="String" resultMap="RoleVO">
		SELECT
			R.RESOURCE_PATTERN,
			A.AUTH_NM
		FROM
			TB_RESOURCE AS R
			INNER JOIN TB_RESOURCE_AUTH AS RA ON (RA.RESOURCE_NO = R.RESOURCE_NO)
			INNER JOIN TB_AUTH AS A ON (RA.AUTH_NO = A.AUTH_NO)
		WHERE
			R.RESOURCE_TYPE = #{type}
		ORDER BY
			R.SORT_ORDER ASC,
			A.AUTH_NO
	</select>
</mapper>